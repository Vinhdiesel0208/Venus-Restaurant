<!DOCTYPE html>
<html lang="en">
<!--begin::Head-->

<head th:replace="fragments/partial :: page_head('Inventory', 'none')" />
<!--end::Head-->
<!--begin::Body-->

<body data-kt-name="metronic" id="kt_app_body"
	data-kt-app-layout="dark-sidebar" data-kt-app-header-fixed="true"
	data-kt-app-sidebar-enabled="true" data-kt-app-sidebar-fixed="true"
	data-kt-app-sidebar-hoverable="true"
	data-kt-app-sidebar-push-header="true"
	data-kt-app-sidebar-push-toolbar="true"
	data-kt-app-sidebar-push-footer="true"
	data-kt-app-toolbar-enabled="true" class="app-default">
	<!--begin::Theme mode setup on page load-->
	<script>
		if (document.documentElement) {
			const defaultThemeMode = "system";
			const name = document.body.getAttribute("data-kt-name");
			let themeMode = localStorage.getItem("kt_"
					+ (name !== null ? name + "_" : "") + "theme_mode_value");
			if (themeMode === null) {
				if (defaultThemeMode === "system") {
					themeMode = window
							.matchMedia("(prefers-color-scheme: dark)").matches ? "dark"
							: "light";
				} else {
					themeMode = defaultThemeMode;
				}
			}
			document.documentElement.setAttribute("data-theme", themeMode);
		}
	</script>
	<!--end::Theme mode setup on page load-->
	<!--begin::App-->
	<div class="d-flex flex-column flex-root app-root" id="kt_app_root">
		<!--begin::Page-->
		<div class="app-page flex-column flex-column-fluid" id="kt_app_page">
			<div th:replace="fragments/header :: header">&nbsp;</div>
			<!--begin::Wrapper-->
			<div class="app-wrapper flex-column flex-row-fluid"
				id="kt_app_wrapper">
				<div th:replace="fragments/sidebar :: sidebar"></div>
				<!--begin::Main-->
				<div class="app-main flex-column flex-row-fluid" id="kt_app_main">
					<!--begin::Content wrapper-->
					<div class="d-flex flex-column flex-column-fluid">
						<!--begin::Toolbar-->
						<div id="kt_app_toolbar" class="app-toolbar py-3 py-lg-6">
							<!--begin::Toolbar container-->
							<div id="kt_app_toolbar_container"
								class="app-container container-xxl d-flex flex-stack">
								<!--begin::Page title-->
								<div
									class="page-title d-flex flex-column justify-content-center flex-wrap me-3">
									<!--begin::Title-->
									<h1
										class="page-heading d-flex text-dark fw-bold fs-3 flex-column justify-content-center my-0">
										Inventory Management</h1>
									<!--end::Title-->
									<!--begin::Breadcrumb-->
									<ul
										class="breadcrumb breadcrumb-separatorless fw-semibold fs-7 my-0 pt-1">
										<!--begin::Item-->
										<li class="breadcrumb-item text-muted"><a
											href="../../demo1/dist/index.html"
											class="text-muted text-hover-primary">Inventory</a></li>
										<!--end::Item-->
										<!--begin::Item-->
										<li class="breadcrumb-item"><span
											class="bullet bg-gray-400 w-5px h-2px"></span></li>
										<!--end::Item-->
										<!--begin::Item-->
										<li class="breadcrumb-item text-muted">Storage</li>
										<!--end::Item-->
									</ul>
									<!--end::Breadcrumb-->
								</div>
								<!--end::Page title-->
							</div>
							<!--end::Toolbar container-->
						</div>
						<!--end::Toolbar-->
						<!--begin::Content-->
						<div id="kt_app_content" class="app-content flex-column-fluid">
							<!--begin::Content container-->
							<div id="kt_app_content_container"
								class="app-container container-xxl">
								<!--begin::Card-->
								<div class="card">
									<!--begin::Card header-->

									<div class="d-flex justify-content-between align-items-center">
										<div>
											<form th:action="@{'/inventory/search'}" method="post"
												class="form-inline">
												<input type="text" name="searchText"
													th:value="${searchText}"
													data-kt-customer-table-filter="search"
													class="form-control form-control-solid w-250px ps-15"
													placeholder="Search Dishes" />

											</form>
										</div>
										<div>
											<a th:href="@{inventory/updateDailyQuantities}" onclick="showConfirmation(event)"
												class="btn btn-light-success me-3"> <span
												class="svg-icon svg-icon-2">Daily Update</span>
											</a>
										</div>

									</div>
									<!--end::Card header-->
									<!--begin::Card body-->
									<div class="card-body pt-0">


										<!--begin::Table-->
										<table class="table align-middle table-row-dashed fs-6 gy-5"
											id="kt_customers_table_skip">
											<!--begin::Table head-->
											<thead>
												<!--begin::Table row-->
												<tr
													class="text-start text-gray-400 fw-bold fs-7 text-uppercase gs-0">

													</th>
													<th
														th:class="${sortField != 'ingredientName' ? 'min-w-125px' : (sortDir == 'asc' ? 'min-w-125px sorting_asc' :  'min-w-125px sorting_desc')}">
														<a
														th:href="@{${moduleURL} + '/page/' + ${currentPage} + '?sortField=ingredientName' +'&sortDir=' + ${sortField != 'ingredientName' ? sortDir : reverseSortDir} + ${searchText != null && searchText != '' ? '&searchText=' + searchText : ''}}">Ingredient
															Name</a>
													</th>
													<th
														th:class="${sortField != 'quantityInStock' ? 'min-w-125px' : (sortDir == 'asc' ? 'min-w-125px sorting_asc' :  'min-w-125px sorting_desc')}">
														<a
														th:href="@{${moduleURL} + '/page/' + ${currentPage} + '?sortField=quantityInStock' +'&sortDir=' + ${sortField != 'quantityInStock' ? sortDir : reverseSortDir} + ${searchText != null && searchText != '' ? '&searchText=' + searchText : ''}}">Quantity
															In Stock</a>
													</th>

													<th
														th:class="${sortField != 'price' ? 'min-w-125px' : (sortDir == 'asc' ? 'min-w-125px sorting_asc' :  'min-w-125px sorting_desc')}">
														<a
														th:href="@{${moduleURL} + '/page/' + ${currentPage} + '?sortField=price' +'&sortDir=' + ${sortField != 'price' ? sortDir : reverseSortDir} + ${searchText != null && searchText != '' ? '&searchText=' + searchText : ''}}"
														style="display: flex; align-items: center;">Price</a>
													</th>
													<th
														th:class="${sortField != 'name' ? 'min-w-125px' : (sortDir == 'asc' ? 'min-w-125px sorting_asc' :  'min-w-125px sorting_desc')}">
														<a
														th:href="@{${moduleURL} + '/page/' + ${currentPage} + '?sortField=name' +'&sortDir=' + ${sortField != 'name' ? sortDir : reverseSortDir} + ${searchText != null && searchText != '' ? '&searchText=' + searchText : ''}}"
														style="display: flex; align-items: center;">Photo</a>
													</th>

													<!-- Add more columns if needed -->


												</tr>
												<!--end::Table row-->
											</thead>
											<!--end::Table head-->
											<!--begin::Table body-->
											<tbody class="fw-semibold text-gray-600">
												<tr th:each="ing : ${listIng}">

													<td><a th:href="@{/ingredient/{id}(id=${ing.id})}"
														class="text-gray-600 text-hover-primary mb-1"
														th:text="${ing.ingredientName}">-</a></td>

													<td><span th:text="${ing.quantityInStock}"></span> <span>
															<a class="btn" data-bs-toggle="modal"
															th:attr="data-bs-target='#kt_modal_update_quantity_' + ${ing.id}"
															data-dish-id="${ing.id}">+</a>
															<div class="modal fade"
																th:id="'kt_modal_update_quantity_' + ${ing.id}"
																tabindex="-1" aria-hidden="true">
																<!--begin::Modal dialog-->
																<div class="modal-dialog modal-dialog-centered mw-650px">
																	<!--begin::Modal content-->
																	<div class="modal-content">
																		<!--begin::-->
																		<form class="form" th:action="@{inventory/updateQuantity}"
																			id="kt_modal_update_quantity_form"
																			data-kt-redirect="ingredient" method="post">
																			<!--begin::Modal header-->
																			<div class="modal-header"
																				id="kt_modal_update_quantity_header">
																				<!--begin::Modal title-->
																				<h2 class="fw-bold">Update Quantity</h2>
																				<!--end::Modal title-->
																				<!--begin::Close-->
																				<div id="kt_modal_update_quantity_close"
																					class="btn btn-icon btn-sm btn-active-icon-primary">
																					<!--begin::Svg Icon | path: icons/duotune/arrows/arr061.svg-->
																					<span class="svg-icon svg-icon-1"> <svg
																							width="24" height="24" viewBox="0 0 24 24"
																							fill="none" xmlns="http://www.w3.org/2000/svg">
																<rect opacity="0.5" x="6" y="17.3137" width="16"
																								height="2" rx="1"
																								transform="rotate(-45 6 17.3137)"
																								fill="currentColor" />
																<rect x="7.41422" y="6" width="16" height="2" rx="1"
																								transform="rotate(45 7.41422 6)"
																								fill="currentColor" />
															</svg>
																					</span>
																					<!--end::Svg Icon-->
																				</div>
																				<!--end::Close-->
																			</div>
																			<!--end::Modal header-->
																			<!--begin::Modal body-->
																			<div class="modal-body py-10 px-lg-17">
																				<!--begin::Scroll-->

																				<div class="scroll-y me-n7 pe-7"
																					id="kt_modal_update_quantity_scroll"
																					data-kt-scroll="true"
																					data-kt-scroll-activate="{default: false, lg: true}"
																					data-kt-scroll-max-height="auto"
																					data-kt-scroll-dependencies="#kt_modal_update_quantity_header"
																					data-kt-scroll-wrappers="#kt_modal_update_quantity_scroll"
																					data-kt-scroll-offset="300px">
																					<!--begin::Input group-->
																					<input type="hidden" id="ingredient_id"
																						name="ingredientId"
																						th:value="${#strings.toString(ing.id)}">
																					<div class="fv-row mb-7">

																						<label class="required fs-6 fw-semibold mb-2">
																							Quantity</label> <input type="number"
																							class="form-control form-control-solid"
																							placeholder="Input Quantity" name="quantity">
																					</div>
																				</div>
																				<!--end::Scroll-->
																			</div>
																			<!--end::Modal body-->
																			<!--begin::Modal footer-->
																			<div class="modal-footer flex-center">
																				<!--begin::Button-->
																				<button type="reset"
																					id="kt_modal_add_customer_cancel"
																					class="btn btn-light me-3">Discard</button>
																				<!--end::Button-->
																				<!--begin::Button-->
																				<button type="submit"
																					id="kt_modal_add_customer_submit"
																					class="btn btn-primary">
																					<span class="indicator-label">Submit</span> <span
																						class="indicator-progress">Please wait... <span
																						class="spinner-border spinner-border-sm align-middle ms-2"></span></span>
																				</button>
																				<!--end::Button-->
																			</div>
																			<!--end::Modal footer-->
																		</form>
																		<!--end::Form-->
																	</div>
																</div>
															</div>


													</span></td>


													<td th:text="${ing.price}"></td>
													<td th:if="${ing.photo}"><img
														th:src="@{${'/files/'+ing.photo}}" alt="User Photo"
														class="img-thumbnail" src="" width="180" height="180">
													</td>


													<!--end::Action=-->
												</tr>
											</tbody>
											<!--end::Table body-->
										</table>
										<!--end::Table-->
										<!--begin::Paginate-->
										<div th:if="${totalPages > 1}">
											<ul class="pagination">
												<li
													th:class="${currentPage > 1 ? 'page-item previous' : 'page-item previous disabled'}">
													<a
													th:href="@{${moduleURL} + '/page/' + ${currentPage - 1} + ${queryParams}}"
													class="page-link"><i class="previous"></i></a>
												</li>
												<li th:each="i : ${#numbers.sequence(1, totalPages)}"
													th:class="${currentPage != i ? 'page-item' : 'page-item active'}">
													<a
													th:href="@{${moduleURL} + '/page/' + ${i} + ${queryParams}}"
													class="page-link" th:text="${i}"></a>
												</li>
												<li
													th:class="${currentPage < totalPages ? 'page-item next' : 'page-item next disabled' }">
													<a
													th:href="@{${moduleURL} + '/page/' + ${currentPage + 1} + ${queryParams}}"
													class="page-link"><i class="next"></i></a>
												</li>
											</ul>
										</div>
										<!--end::Paginate-->
									</div>
									<!--end::Card body-->

									<!--end::Card-->


									<!--end::Form-->
								</div>
							</div>

						</div>
						<!--end::Content container-->
					</div>
					<!--end::Content-->
				</div>
				<!--end::Content wrapper-->
				<!--begin::Footer-->
				<div th:replace="fragments/footer :: footer">&nbsp;</div>
				<!--end::Footer-->
			</div>
			<!--end:::Main-->
		</div>
		<!--end::Wrapper-->
	</div>
	<!--end::Page-->
	<script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>
	<script type="text/javascript">
    // Function to show SweetAlert confirmation
    function showConfirmation(event) {
        // Prevent default action of the link
        event.preventDefault();

        // Show SweetAlert confirmation dialog
        Swal.fire({
            title: 'Are you sure?',
            text: "This action will update daily quantities!",
            icon: 'warning',
            showCancelButton: true,
            confirmButtonColor: '#3085d6',
            cancelButtonColor: '#d33',
            confirmButtonText: 'Yes, update it!'
        }).then((result) => {
            if (result.isConfirmed) {
                // If confirmed, redirect to /inventory/updateDailyQuantities
                window.location.href = "/inventory/updateDailyQuantities";
            }
        });
    }
</script>
	<!--end::App-->
	<!--begin::Scrolltop-->
	<div id="kt_scrolltop" class="scrolltop" data-kt-scrolltop="true">
		<!--begin::Svg Icon | path: icons/duotune/arrows/arr066.svg-->
		<span class="svg-icon"> <svg width="24" height="24"
				viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
				<rect opacity="0.5" x="13" y="6" width="13" height="2" rx="1"
					transform="rotate(90 13 6)" fill="currentColor" />
				<path
					d="M12.5657 8.56569L16.75 12.75C17.1642 13.1642 17.8358 13.1642 18.25 12.75C18.6642 12.3358 18.6642 11.6642 18.25 11.25L12.7071 5.70711C12.3166 5.31658 11.6834 5.31658 11.2929 5.70711L5.75 11.25C5.33579 11.6642 5.33579 12.3358 5.75 12.75C6.16421 13.1642 6.83579 13.1642 7.25 12.75L11.4343 8.56569C11.7467 8.25327 12.2533 8.25327 12.5657 8.56569Z"
					fill="currentColor" />
			</svg>
		</span>
		<!--end::Svg Icon-->
	</div>
	<!--end::Scrolltop-->
	<!--begin::Javascript-->
	<div th:replace="fragments/partial :: global_script"></div>
	<div th:replace="fragments/partial :: users_script"></div>
	<!--end::Javascript-->
</body>
<!--end::Body-->

</html>